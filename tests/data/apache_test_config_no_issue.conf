#############################################################
# This configuration test must trigger NO audit rules
#############################################################
# See https://httpd.apache.org/docs/2.4/mod
# Point 2.1
# LoadModule auth_digest_module modules/mod_auth_digest.so
LoadModule auth_form_module modules/mod_auth_form.so
LoadModule authn_anon_module modules/mod_authn_anon.so
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authn_socache_module modules/mod_authn_socache.so
# LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
# LoadModule ldap_module modules/mod_ldap.so
# Point 2.2
LoadModule log_config_module modules/mod_log_config.so
# Point 2.3
# LoadModule dav_module modules/mod_dav.so
# LoadModule dav_fs_module modules/mod_dav_fs.so
# Point 2.4
# LoadModule status_module modules/mod_status.so
# Point 2.5
# LoadModule autoindex_module modules/mod_autoindex.so
# Point 2.6
# LoadModule proxy_module modules/mod_proxy.so
# LoadModule proxy_connect_module modules/mod_proxy_connect.so
# LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
# LoadModule proxy_http_module modules/mod_proxy_http.so
# LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
# LoadModule proxy_scgi_module modules/mod_proxy_scgi.so
# LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
# LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
# LoadModule proxy_express_module modules/mod_proxy_express.so
# LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so
# LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so
# Point 2.7
# LoadModule userdir_module modules/mod_userdir.so
# Point 2.8
# LoadModule info_module modules/mod_info.so
# Point 2.9
# LoadModule mod_auth_digest modules/mod_auth_digest.so
# Point 3.1
User apache
Group apache
# Point 4.1
<Directory>
    Require all denied
</Directory>
<Directory "/var/www/html/">
# Point 4.2
    Require all denied
# Point 5.2
    Options None
</Directory>
# Point 4.2
<Location /portal>
    Require valid-user
</Location>
<Directory />
# Point 4.3
    AllowOverride None
# Point 5.1
    Options None
# Point 5.1
#   Options Includes all
</Directory>
# Point 4.4
AllowOverride None
# Point 5.8
TraceEnable off
# Point 5.9
LoadModule rewrite_module modules/mod_rewrite.so
RewriteEngine On
RewriteCond %{THE_REQUEST} !HTTP/1\.1$
RewriteRule .* - [F]
# Point 5.11
<FilesMatch "^.*$">
    Require all denied
</FilesMatch> 
# Point 5.12
LoadModule rewrite_module modules/mod_rewrite.so
RewriteCond %{HTTP_HOST} !^www\.example\.com [NC]
RewriteCond %{REQUEST_URI} !^/error [NC]
RewriteRule ^.(.*) - [L,F]
# Point 5.13
Listen 10.1.2.3:80
Listen 192.168.4.5:80
Listen [2001:db8::a00:20ff:fea7:ccea]:80
# Point 5.14
Header always append X-Frame-Options SAMEORIGIN
# Point 6.1
LogLevel warn core:info
# Point 6.2
ErrorLog "syslog:local1"
# Point 6.3
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
CustomLog log/access_log combined